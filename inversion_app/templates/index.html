{% extends "base.html" %}

{% block content %}
<div class="col">
    <h2><i class="bi bi-list-ul"></i> Movimientos</h2>
    <p class="text-muted">Historial de todas tus transacciones</p>
</div>

{% if transactions %}
<div class="table-responsive">
    <table class="table table-striped table-hover">
        <thead class="table-dark">
            <tr>
                <th>Fecha</th>
                <th>Hora</th>
                <th>De</th>
                <th>Cantidad</th>
                <th>A</th>
                <th>Cantidad</th>
                <th>Tipo</th>
            </tr>
        </thead>
        <tbody>
            {% for transaction in transactions %}
            <tr>
                <td>{{ transaction.date }}</td>
                <td>{{ transaction.time }}</td>
                <td>
                    <span class="badge bg-secondary">{{ transaction.currency_from }}</span>
                </td>
                <td class="text-end">
                    {% if transaction.amount_from >= 1 %}
                        {{ "%.2f" | format(transaction.amount_from) }}
                    {% elif transaction.amount_to >= 0.01 %}
                        {{ "%.4f" | format(transaction.amount_from) }}
                    {% else %}
                        {{ "%.8f" | format(transaction.amount_from) }}
                    {% endif %}
                </td>
                <td>
                    <span class="badge bg-secondary">{{ transaction.currency_to }}</span>
                </td>
                <td class="text-end">
                    {% if transaction.amount_to >= 1 %}
                        {{ "%.2f" | format(transaction.amount_to) }}
                    {% elif transaction.amount_to >= 0.01 %}
                        {{ "%.4f" | format(transaction.amount_to) }}
                    {% else %}
                        {{ "%.8f" | format(transaction.amount_to) }}
                    {% endif %}
                </td>
                <td>
                    {% if transaction.currency_from == 'EUR' %}
                        <span class="badge bg-success">
                            <i class="bi bi-cart-plus"></i> Compra
                        </span>
                    {% elif transaction.currency_to == 'EUR' %}
                        <span class="badge bg-danger">
                            <i class="bi bi-cash-coin"></i> Venta
                        </span>
                    {% else %}
                        <span class="badge bg-info">
                            <i class="bi bi-arrow-left-right"></i> Tradeo
                        </span>
                    {% endif %}
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% else %}
<div class="alert alert-info text-center" role="alert">
    <i class="bi bi-info-circle fs-1 d-block mb-3"></i>
    <h4>SIN MOVIMIENTOS</h4>
    <p class="mb-3">Aún no has realizado ninguna transacción</p>
    <a href="/purchase" class="btn btn-primary">
        <i class="bi bi-cart-plus"></i> Realizar primera compra
    </a>
</div>
{% endif %}
<!-- Feedback message -->
    {% if message %}
        <div class="alert alert-info mt-4">
            {{ message }}
        </div>
    {% endif %}
{% endblock %}